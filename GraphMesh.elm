module GraphMesh exposing (mesh, cube, dodecahedron, c60, fulleroidI_5_8)

import Math.Vector3 exposing (vec3)
import WebGL
import Embed
import Renderer


mesh : Embed.Embedder -> Embed.Adjacencies -> WebGL.Mesh Renderer.Vertex
mesh embedder adj =
    let
        pos =
            embedder adj

        meshVertex v =
            let
                p =
                    Embed.getPos v pos
            in
                { color = (vec3 1 1 1), pos = p, normal = p }

        meshEdge ( v, w ) =
            ( meshVertex v, meshVertex w )
    in
        WebGL.lines <| List.map meshEdge <| Embed.edges adj



-- Some example graphs


cube : Embed.Adjacencies
cube =
    Embed.adjacencies
        [ [ 4, 3, 1 ]
        , [ 5, 0, 2 ]
        , [ 6, 1, 3 ]
        , [ 7, 2, 0 ]
        , [ 0, 5, 7 ]
        , [ 1, 6, 4 ]
        , [ 2, 7, 5 ]
        , [ 3, 4, 6 ]
        ]


dodecahedron : Embed.Adjacencies
dodecahedron =
    Embed.adjacencies
        [ [ 1, 5, 4 ]
        , [ 2, 6, 0 ]
        , [ 3, 7, 1 ]
        , [ 4, 8, 2 ]
        , [ 0, 9, 3 ]
        , [ 0, 11, 10 ]
        , [ 1, 12, 11 ]
        , [ 2, 13, 12 ]
        , [ 3, 14, 13 ]
        , [ 4, 10, 14 ]
        , [ 5, 15, 9 ]
        , [ 6, 19, 5 ]
        , [ 7, 18, 6 ]
        , [ 8, 17, 7 ]
        , [ 9, 16, 8 ]
        , [ 10, 19, 16 ]
        , [ 14, 15, 17 ]
        , [ 13, 16, 18 ]
        , [ 12, 17, 19 ]
        , [ 11, 18, 15 ]
        ]


c60 : Embed.Adjacencies
c60 =
    Embed.adjacencies <|
        [ [ 17, 18, 1 ]
        , [ 0, 2, 39 ]
        , [ 1, 31, 3 ]
        , [ 2, 4, 40 ]
        , [ 3, 29, 5 ]
        , [ 4, 6, 42 ]
        , [ 5, 28, 7 ]
        , [ 6, 8, 44 ]
        , [ 7, 26, 9 ]
        , [ 8, 10, 45 ]
        , [ 9, 24, 11 ]
        , [ 10, 12, 47 ]
        , [ 11, 23, 13 ]
        , [ 12, 14, 49 ]
        , [ 13, 21, 15 ]
        , [ 14, 16, 50 ]
        , [ 15, 19, 17 ]
        , [ 16, 0, 52 ]
        , [ 0, 19, 32 ]
        , [ 18, 16, 20 ]
        , [ 19, 21, 34 ]
        , [ 20, 14, 22 ]
        , [ 21, 23, 35 ]
        , [ 22, 12, 24 ]
        , [ 23, 10, 25 ]
        , [ 24, 26, 36 ]
        , [ 25, 8, 27 ]
        , [ 26, 28, 37 ]
        , [ 27, 6, 29 ]
        , [ 28, 4, 30 ]
        , [ 29, 31, 38 ]
        , [ 30, 2, 32 ]
        , [ 31, 18, 33 ]
        , [ 32, 34, 38 ]
        , [ 33, 20, 35 ]
        , [ 34, 22, 36 ]
        , [ 35, 25, 37 ]
        , [ 36, 27, 38 ]
        , [ 37, 30, 33 ]
        , [ 1, 40, 53 ]
        , [ 39, 3, 41 ]
        , [ 40, 42, 55 ]
        , [ 41, 5, 43 ]
        , [ 42, 44, 56 ]
        , [ 43, 7, 45 ]
        , [ 44, 9, 46 ]
        , [ 45, 47, 57 ]
        , [ 46, 11, 48 ]
        , [ 47, 49, 58 ]
        , [ 48, 13, 50 ]
        , [ 49, 15, 51 ]
        , [ 50, 52, 59 ]
        , [ 51, 17, 53 ]
        , [ 52, 39, 54 ]
        , [ 53, 55, 59 ]
        , [ 54, 41, 56 ]
        , [ 55, 43, 57 ]
        , [ 56, 46, 58 ]
        , [ 57, 48, 59 ]
        , [ 58, 51, 54 ]
        ]


fulleroidI_5_8 : Embed.Adjacencies
fulleroidI_5_8 =
    Embed.adjacencies <|
        [ [ 4, 1, 16 ]
        , [ 2, 6, 0 ]
        , [ 5, 3, 1 ]
        , [ 2, 15, 10 ]
        , [ 21, 5, 0 ]
        , [ 4, 11, 2 ]
        , [ 1, 7, 17 ]
        , [ 18, 30, 6 ]
        , [ 31, 9, 19 ]
        , [ 8, 18, 10 ]
        , [ 9, 3, 20 ]
        , [ 22, 12, 5 ]
        , [ 11, 39, 23 ]
        , [ 24, 14, 40 ]
        , [ 15, 23, 13 ]
        , [ 25, 3, 14 ]
        , [ 0, 17, 43 ]
        , [ 6, 26, 16 ]
        , [ 32, 7, 9 ]
        , [ 8, 20, 50 ]
        , [ 10, 33, 19 ]
        , [ 43, 22, 4 ]
        , [ 21, 35, 11 ]
        , [ 14, 12, 41 ]
        , [ 57, 25, 13 ]
        , [ 24, 42, 15 ]
        , [ 17, 27, 44 ]
        , [ 45, 61, 26 ]
        , [ 62, 29, 46 ]
        , [ 28, 45, 30 ]
        , [ 29, 7, 47 ]
        , [ 65, 32, 8 ]
        , [ 31, 48, 18 ]
        , [ 20, 34, 51 ]
        , [ 42, 71, 33 ]
        , [ 44, 36, 22 ]
        , [ 35, 72, 52 ]
        , [ 53, 38, 73 ]
        , [ 39, 52, 37 ]
        , [ 54, 12, 38 ]
        , [ 13, 41, 76 ]
        , [ 23, 55, 40 ]
        , [ 58, 34, 25 ]
        , [ 16, 44, 21 ]
        , [ 26, 35, 43 ]
        , [ 63, 27, 29 ]
        , [ 28, 47, 86 ]
        , [ 30, 64, 46 ]
        , [ 66, 49, 32 ]
        , [ 48, 90, 64 ]
        , [ 19, 51, 65 ]
        , [ 33, 67, 50 ]
        , [ 38, 36, 74 ]
        , [ 96, 54, 37 ]
        , [ 53, 75, 39 ]
        , [ 41, 56, 77 ]
        , [ 75, 100, 55 ]
        , [ 76, 58, 24 ]
        , [ 57, 78, 42 ]
        , [ 92, 60, 82 ]
        , [ 59, 72, 61 ]
        , [ 60, 27, 83 ]
        , [ 103, 63, 28 ]
        , [ 62, 84, 45 ]
        , [ 47, 49, 87 ]
        , [ 50, 66, 31 ]
        , [ 65, 67, 48 ]
        , [ 51, 68, 66 ]
        , [ 91, 109, 67 ]
        , [ 110, 70, 80 ]
        , [ 69, 91, 71 ]
        , [ 70, 34, 81 ]
        , [ 93, 36, 60 ]
        , [ 37, 74, 113 ]
        , [ 52, 94, 73 ]
        , [ 97, 56, 54 ]
        , [ 40, 77, 57 ]
        , [ 55, 78, 76 ]
        , [ 77, 79, 58 ]
        , [ 78, 119, 101 ]
        , [ 69, 81, 120 ]
        , [ 71, 101, 80 ]
        , [ 59, 83, 122 ]
        , [ 61, 102, 82 ]
        , [ 104, 85, 63 ]
        , [ 84, 126, 102 ]
        , [ 46, 87, 103 ]
        , [ 64, 105, 86 ]
        , [ 107, 89, 128 ]
        , [ 90, 109, 88 ]
        , [ 108, 49, 89 ]
        , [ 111, 68, 70 ]
        , [ 132, 93, 59 ]
        , [ 92, 112, 72 ]
        , [ 74, 95, 114 ]
        , [ 112, 136, 94 ]
        , [ 113, 97, 53 ]
        , [ 96, 115, 75 ]
        , [ 138, 99, 117 ]
        , [ 98, 119, 100 ]
        , [ 99, 56, 118 ]
        , [ 81, 79, 121 ]
        , [ 83, 85, 123 ]
        , [ 86, 104, 62 ]
        , [ 103, 105, 84 ]
        , [ 87, 106, 104 ]
        , [ 127, 146, 105 ]
        , [ 147, 108, 88 ]
        , [ 107, 127, 90 ]
        , [ 89, 68, 129 ]
        , [ 150, 111, 69 ]
        , [ 110, 130, 91 ]
        , [ 133, 95, 93 ]
        , [ 73, 114, 96 ]
        , [ 94, 115, 113 ]
        , [ 114, 116, 97 ]
        , [ 115, 154, 137 ]
        , [ 98, 118, 155 ]
        , [ 100, 137, 117 ]
        , [ 139, 79, 99 ]
        , [ 80, 121, 150 ]
        , [ 101, 140, 120 ]
        , [ 82, 123, 132 ]
        , [ 102, 142, 122 ]
        , [ 144, 125, 159 ]
        , [ 126, 146, 124 ]
        , [ 145, 85, 125 ]
        , [ 148, 106, 108 ]
        , [ 88, 129, 163 ]
        , [ 109, 149, 128 ]
        , [ 151, 131, 111 ]
        , [ 130, 167, 149 ]
        , [ 122, 133, 92 ]
        , [ 132, 142, 112 ]
        , [ 169, 135, 152 ]
        , [ 134, 154, 136 ]
        , [ 135, 95, 153 ]
        , [ 118, 116, 156 ]
        , [ 173, 139, 98 ]
        , [ 138, 157, 119 ]
        , [ 121, 141, 151 ]
        , [ 157, 175, 140 ]
        , [ 123, 143, 133 ]
        , [ 158, 168, 142 ]
        , [ 176, 145, 124 ]
        , [ 144, 158, 126 ]
        , [ 125, 106, 160 ]
        , [ 163, 148, 107 ]
        , [ 147, 161, 127 ]
        , [ 129, 131, 164 ]
        , [ 120, 151, 110 ]
        , [ 150, 140, 130 ]
        , [ 134, 153, 181 ]
        , [ 136, 168, 152 ]
        , [ 170, 116, 135 ]
        , [ 117, 156, 173 ]
        , [ 137, 171, 155 ]
        , [ 174, 141, 139 ]
        , [ 177, 143, 145 ]
        , [ 124, 160, 188 ]
        , [ 146, 178, 159 ]
        , [ 164, 162, 148 ]
        , [ 161, 190, 178 ]
        , [ 128, 164, 147 ]
        , [ 149, 161, 163 ]
        , [ 179, 166, 184 ]
        , [ 167, 175, 165 ]
        , [ 180, 131, 166 ]
        , [ 153, 143, 182 ]
        , [ 192, 170, 134 ]
        , [ 169, 183, 154 ]
        , [ 156, 172, 174 ]
        , [ 183, 194, 171 ]
        , [ 155, 174, 138 ]
        , [ 173, 171, 157 ]
        , [ 166, 141, 185 ]
        , [ 188, 177, 144 ]
        , [ 176, 186, 158 ]
        , [ 160, 162, 189 ]
        , [ 195, 180, 165 ]
        , [ 179, 190, 167 ]
        , [ 152, 182, 192 ]
        , [ 168, 191, 181 ]
        , [ 193, 172, 170 ]
        , [ 165, 185, 197 ]
        , [ 175, 194, 184 ]
        , [ 189, 187, 177 ]
        , [ 186, 199, 191 ]
        , [ 159, 189, 176 ]
        , [ 178, 186, 188 ]
        , [ 196, 162, 180 ]
        , [ 182, 187, 193 ]
        , [ 181, 193, 169 ]
        , [ 192, 191, 183 ]
        , [ 185, 172, 198 ]
        , [ 197, 196, 179 ]
        , [ 195, 199, 190 ]
        , [ 184, 198, 195 ]
        , [ 194, 199, 197 ]
        , [ 198, 187, 196 ]
        ]
