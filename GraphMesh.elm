module GraphMesh exposing (mesh, cube, dodecahedron, c60, fulleroidI_5_8)

import Math.Vector3 exposing (vec3)
import WebGL
import Embed
import Renderer


mesh : Embed.Embedder -> Embed.Adjacencies -> WebGL.Mesh Renderer.Vertex
mesh embedder adj =
    let
        pos =
            embedder adj

        meshVertex v =
            let
                p =
                    Embed.getPos v pos
            in
                { color = (vec3 1 1 1), pos = p, normal = p }

        meshEdge ( v, w ) =
            ( meshVertex v, meshVertex w )
    in
        WebGL.lines <| List.map meshEdge <| Embed.edges adj



-- Some example graphs


cube : Embed.Adjacencies
cube =
    Embed.adjacencies
        [ [ 4, 3, 1 ]
        , [ 5, 0, 2 ]
        , [ 6, 1, 3 ]
        , [ 7, 2, 0 ]
        , [ 0, 5, 7 ]
        , [ 1, 6, 4 ]
        , [ 2, 7, 5 ]
        , [ 3, 4, 6 ]
        ]


dodecahedron : Embed.Adjacencies
dodecahedron =
    Embed.adjacencies
        [ [ 1, 5, 4 ]
        , [ 2, 6, 0 ]
        , [ 3, 7, 1 ]
        , [ 4, 8, 2 ]
        , [ 0, 9, 3 ]
        , [ 0, 11, 10 ]
        , [ 1, 12, 11 ]
        , [ 2, 13, 12 ]
        , [ 3, 14, 13 ]
        , [ 4, 10, 14 ]
        , [ 5, 15, 9 ]
        , [ 6, 19, 5 ]
        , [ 7, 18, 6 ]
        , [ 8, 17, 7 ]
        , [ 9, 16, 8 ]
        , [ 10, 19, 16 ]
        , [ 14, 15, 17 ]
        , [ 13, 16, 18 ]
        , [ 12, 17, 19 ]
        , [ 11, 18, 15 ]
        ]


c60 : Embed.Adjacencies
c60 =
    Embed.adjacencies <|
        List.map (\a -> List.map (\v -> v - 1) a) <|
            [ [ 18, 19, 2 ]
            , [ 1, 3, 40 ]
            , [ 2, 32, 4 ]
            , [ 3, 5, 41 ]
            , [ 4, 30, 6 ]
            , [ 5, 7, 43 ]
            , [ 6, 29, 8 ]
            , [ 7, 9, 45 ]
            , [ 8, 27, 10 ]
            , [ 9, 11, 46 ]
            , [ 10, 25, 12 ]
            , [ 11, 13, 48 ]
            , [ 12, 24, 14 ]
            , [ 13, 15, 50 ]
            , [ 14, 22, 16 ]
            , [ 15, 17, 51 ]
            , [ 16, 20, 18 ]
            , [ 17, 1, 53 ]
            , [ 1, 20, 33 ]
            , [ 19, 17, 21 ]
            , [ 20, 22, 35 ]
            , [ 21, 15, 23 ]
            , [ 22, 24, 36 ]
            , [ 23, 13, 25 ]
            , [ 24, 11, 26 ]
            , [ 25, 27, 37 ]
            , [ 26, 9, 28 ]
            , [ 27, 29, 38 ]
            , [ 28, 7, 30 ]
            , [ 29, 5, 31 ]
            , [ 30, 32, 39 ]
            , [ 31, 3, 33 ]
            , [ 32, 19, 34 ]
            , [ 33, 35, 39 ]
            , [ 34, 21, 36 ]
            , [ 35, 23, 37 ]
            , [ 36, 26, 38 ]
            , [ 37, 28, 39 ]
            , [ 38, 31, 34 ]
            , [ 2, 41, 54 ]
            , [ 40, 4, 42 ]
            , [ 41, 43, 56 ]
            , [ 42, 6, 44 ]
            , [ 43, 45, 57 ]
            , [ 44, 8, 46 ]
            , [ 45, 10, 47 ]
            , [ 46, 48, 58 ]
            , [ 47, 12, 49 ]
            , [ 48, 50, 59 ]
            , [ 49, 14, 51 ]
            , [ 50, 16, 52 ]
            , [ 51, 53, 60 ]
            , [ 52, 18, 54 ]
            , [ 53, 40, 55 ]
            , [ 54, 56, 60 ]
            , [ 55, 42, 57 ]
            , [ 56, 44, 58 ]
            , [ 57, 47, 59 ]
            , [ 58, 49, 60 ]
            , [ 59, 52, 55 ]
            ]


fulleroidI_5_8 : Embed.Adjacencies
fulleroidI_5_8 =
    Embed.adjacencies <|
        List.map (\a -> List.map (\v -> v - 1) a) <|
            [ [ 5, 2, 17 ]
            , [ 3, 7, 1 ]
            , [ 6, 4, 2 ]
            , [ 3, 16, 11 ]
            , [ 22, 6, 1 ]
            , [ 5, 12, 3 ]
            , [ 2, 8, 18 ]
            , [ 19, 31, 7 ]
            , [ 32, 10, 20 ]
            , [ 9, 19, 11 ]
            , [ 10, 4, 21 ]
            , [ 23, 13, 6 ]
            , [ 12, 40, 24 ]
            , [ 25, 15, 41 ]
            , [ 16, 24, 14 ]
            , [ 26, 4, 15 ]
            , [ 1, 18, 44 ]
            , [ 7, 27, 17 ]
            , [ 33, 8, 10 ]
            , [ 9, 21, 51 ]
            , [ 11, 34, 20 ]
            , [ 44, 23, 5 ]
            , [ 22, 36, 12 ]
            , [ 15, 13, 42 ]
            , [ 58, 26, 14 ]
            , [ 25, 43, 16 ]
            , [ 18, 28, 45 ]
            , [ 46, 62, 27 ]
            , [ 63, 30, 47 ]
            , [ 29, 46, 31 ]
            , [ 30, 8, 48 ]
            , [ 66, 33, 9 ]
            , [ 32, 49, 19 ]
            , [ 21, 35, 52 ]
            , [ 43, 72, 34 ]
            , [ 45, 37, 23 ]
            , [ 36, 73, 53 ]
            , [ 54, 39, 74 ]
            , [ 40, 53, 38 ]
            , [ 55, 13, 39 ]
            , [ 14, 42, 77 ]
            , [ 24, 56, 41 ]
            , [ 59, 35, 26 ]
            , [ 17, 45, 22 ]
            , [ 27, 36, 44 ]
            , [ 64, 28, 30 ]
            , [ 29, 48, 87 ]
            , [ 31, 65, 47 ]
            , [ 67, 50, 33 ]
            , [ 49, 91, 65 ]
            , [ 20, 52, 66 ]
            , [ 34, 68, 51 ]
            , [ 39, 37, 75 ]
            , [ 97, 55, 38 ]
            , [ 54, 76, 40 ]
            , [ 42, 57, 78 ]
            , [ 76, 101, 56 ]
            , [ 77, 59, 25 ]
            , [ 58, 79, 43 ]
            , [ 93, 61, 83 ]
            , [ 60, 73, 62 ]
            , [ 61, 28, 84 ]
            , [ 104, 64, 29 ]
            , [ 63, 85, 46 ]
            , [ 48, 50, 88 ]
            , [ 51, 67, 32 ]
            , [ 66, 68, 49 ]
            , [ 52, 69, 67 ]
            , [ 92, 110, 68 ]
            , [ 111, 71, 81 ]
            , [ 70, 92, 72 ]
            , [ 71, 35, 82 ]
            , [ 94, 37, 61 ]
            , [ 38, 75, 114 ]
            , [ 53, 95, 74 ]
            , [ 98, 57, 55 ]
            , [ 41, 78, 58 ]
            , [ 56, 79, 77 ]
            , [ 78, 80, 59 ]
            , [ 79, 120, 102 ]
            , [ 70, 82, 121 ]
            , [ 72, 102, 81 ]
            , [ 60, 84, 123 ]
            , [ 62, 103, 83 ]
            , [ 105, 86, 64 ]
            , [ 85, 127, 103 ]
            , [ 47, 88, 104 ]
            , [ 65, 106, 87 ]
            , [ 108, 90, 129 ]
            , [ 91, 110, 89 ]
            , [ 109, 50, 90 ]
            , [ 112, 69, 71 ]
            , [ 133, 94, 60 ]
            , [ 93, 113, 73 ]
            , [ 75, 96, 115 ]
            , [ 113, 137, 95 ]
            , [ 114, 98, 54 ]
            , [ 97, 116, 76 ]
            , [ 139, 100, 118 ]
            , [ 99, 120, 101 ]
            , [ 100, 57, 119 ]
            , [ 82, 80, 122 ]
            , [ 84, 86, 124 ]
            , [ 87, 105, 63 ]
            , [ 104, 106, 85 ]
            , [ 88, 107, 105 ]
            , [ 128, 147, 106 ]
            , [ 148, 109, 89 ]
            , [ 108, 128, 91 ]
            , [ 90, 69, 130 ]
            , [ 151, 112, 70 ]
            , [ 111, 131, 92 ]
            , [ 134, 96, 94 ]
            , [ 74, 115, 97 ]
            , [ 95, 116, 114 ]
            , [ 115, 117, 98 ]
            , [ 116, 155, 138 ]
            , [ 99, 119, 156 ]
            , [ 101, 138, 118 ]
            , [ 140, 80, 100 ]
            , [ 81, 122, 151 ]
            , [ 102, 141, 121 ]
            , [ 83, 124, 133 ]
            , [ 103, 143, 123 ]
            , [ 145, 126, 160 ]
            , [ 127, 147, 125 ]
            , [ 146, 86, 126 ]
            , [ 149, 107, 109 ]
            , [ 89, 130, 164 ]
            , [ 110, 150, 129 ]
            , [ 152, 132, 112 ]
            , [ 131, 168, 150 ]
            , [ 123, 134, 93 ]
            , [ 133, 143, 113 ]
            , [ 170, 136, 153 ]
            , [ 135, 155, 137 ]
            , [ 136, 96, 154 ]
            , [ 119, 117, 157 ]
            , [ 174, 140, 99 ]
            , [ 139, 158, 120 ]
            , [ 122, 142, 152 ]
            , [ 158, 176, 141 ]
            , [ 124, 144, 134 ]
            , [ 159, 169, 143 ]
            , [ 177, 146, 125 ]
            , [ 145, 159, 127 ]
            , [ 126, 107, 161 ]
            , [ 164, 149, 108 ]
            , [ 148, 162, 128 ]
            , [ 130, 132, 165 ]
            , [ 121, 152, 111 ]
            , [ 151, 141, 131 ]
            , [ 135, 154, 182 ]
            , [ 137, 169, 153 ]
            , [ 171, 117, 136 ]
            , [ 118, 157, 174 ]
            , [ 138, 172, 156 ]
            , [ 175, 142, 140 ]
            , [ 178, 144, 146 ]
            , [ 125, 161, 189 ]
            , [ 147, 179, 160 ]
            , [ 165, 163, 149 ]
            , [ 162, 191, 179 ]
            , [ 129, 165, 148 ]
            , [ 150, 162, 164 ]
            , [ 180, 167, 185 ]
            , [ 168, 176, 166 ]
            , [ 181, 132, 167 ]
            , [ 154, 144, 183 ]
            , [ 193, 171, 135 ]
            , [ 170, 184, 155 ]
            , [ 157, 173, 175 ]
            , [ 184, 195, 172 ]
            , [ 156, 175, 139 ]
            , [ 174, 172, 158 ]
            , [ 167, 142, 186 ]
            , [ 189, 178, 145 ]
            , [ 177, 187, 159 ]
            , [ 161, 163, 190 ]
            , [ 196, 181, 166 ]
            , [ 180, 191, 168 ]
            , [ 153, 183, 193 ]
            , [ 169, 192, 182 ]
            , [ 194, 173, 171 ]
            , [ 166, 186, 198 ]
            , [ 176, 195, 185 ]
            , [ 190, 188, 178 ]
            , [ 187, 200, 192 ]
            , [ 160, 190, 177 ]
            , [ 179, 187, 189 ]
            , [ 197, 163, 181 ]
            , [ 183, 188, 194 ]
            , [ 182, 194, 170 ]
            , [ 193, 192, 184 ]
            , [ 186, 173, 199 ]
            , [ 198, 197, 180 ]
            , [ 196, 200, 191 ]
            , [ 185, 199, 196 ]
            , [ 195, 200, 198 ]
            , [ 199, 188, 197 ]
            ]
